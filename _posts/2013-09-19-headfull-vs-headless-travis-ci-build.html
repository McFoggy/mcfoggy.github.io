---
layout: post
title: Headfull vs headless Travis-CI build
date: '2013-09-19T09:24:00.001+02:00'
author: Matthieu BROUILLARD
tags: 
modified_time: '2013-09-19T09:28:24.545+02:00'
blogger_id: tag:blogger.com,1999:blog-1656175910479000188.post-929745500750068315
blogger_orig_url: http://blog.matthieu.brouillard.fr/2013/09/headfull-vs-headless-travis-ci-build.html
---

<span style="font-family: Verdana,sans-serif;">Yesterday I tried to introduce continuous integration for <a href="http://jfxtras.org/">JFXTras</a> using <a href="https://travis-ci.org/">Travis-CI</a>.</span><br /><span style="font-family: Verdana,sans-serif;"><br /></span><span style="font-family: Verdana,sans-serif;">The JFXtras project uses gradle as its build tool, so using Travis for CI wasn't more difficult than just:</span><br /><ul><li><span style="font-family: Verdana,sans-serif;">declaring my <a href="http://github.com/McFoggy/jfxtras-labs">github fork</a> in <a href="https://travis-ci.org/McFoggy/jfxtras-labs">travis</a></span></li><li><span style="font-family: Verdana,sans-serif;">adding a trivial .travis.yml file and <a href="https://github.com/McFoggy/jfxtras-labs/commit/2de20fe9bbc9105ead62aea613e92a6f15eeb1ce">pushing it to github</a></span></li></ul><span style="font-family: Verdana,sans-serif;">After few minutes Travis started a build that performed well until a test failure...</span><br /><span style="font-family: Verdana,sans-serif;"><br />Digging into the log file there was the following</span><br /><pre class="brush">... Failed in XOpenDisplay<br /> ... Gtk-WARNING **: cannot open display: &nbsp;</pre><pre><br /></pre><span style="font-family: Verdana,sans-serif;">In fact, JFXtras tests use Jemmy to realize GUI tests. So the build process has to be headfull and not headless. So we need an X environment !!!</span><br /><span style="font-family: Verdana,sans-serif;"><br /></span><span style="font-family: Verdana,sans-serif;">After a quick google, I found <a href="http://ecmendenhall.github.io/blog/blog/2013/05/28/two-travis-ci-solutions/">this blog post</a>. </span><br /><span style="font-family: Verdana,sans-serif;"><br /></span><span style="font-family: Verdana,sans-serif;">As a result the .travis.yml file was <a href="https://github.com/McFoggy/jfxtras-labs/commit/0048e10c0cc29bd108f5599f9a24d5d195d24536">changed </a>to</span><br /><pre class="brush"><br />language: java<br />before_install: <br />  - "export DISPLAY=:99.0"<br />  - "sh -e /etc/init.d/xvfb start"<br />jdk: <br />  - oraclejdk7<br /></pre><br /><span style="font-family: Verdana, sans-serif;">Travis build could then perform the GUI tests correctly and build status became green again !</span>